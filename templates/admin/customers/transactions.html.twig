{% extends 'layout/_admin.html.twig' %}

{% block title %}{{ customer.companyName }} - Ekstre{% endblock %}

{% block toolbar %}
    <div class="d-flex gap-2">
        <a href="{{ path('admin_customers_transactions_create', {id: customer.id}) }}" class="btn btn-sm btn-primary">Yeni İşlem</a>
        <a href="{{ path('admin_customers_view', {id: customer.id}) }}" class="btn btn-sm btn-light">Geri</a>
    </div>
{% endblock %}

{% block content %}
    <div class="card">
        <div class="card-body">
            <h4>Ekstre - {{ customer.companyName }}</h4>
            <table class="table">
                <thead>
                    <tr>
                        <th>Tarih</th>
                        <th>Tür</th>
                        <th>Açıklama</th>
                        <th class="text-end">Tutar</th>
                    </tr>
                </thead>
                <tbody>
                    {% set balance = 0 %}
                    {% for tx in transactions %}
                        {% if tx.type == 'debit' %}
                            {% set balance = balance - tx.amount %}
                        {% else %}
                            {% set balance = balance + tx.amount %}
                        {% endif %}
                        <tr>
                            <td>{{ tx.createdAt ? tx.createdAt|date('d.m.Y H:i') : '-' }}</td>
                            <td>{{ tx.type|upper }}</td>
                            <td>{{ tx.description ?: '-' }}</td>
                            <td class="text-end">{{ tx.amount }} {{ tx.currency }}</td>
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="4" class="text-center text-muted">İşlem yok</td>
                        </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <th colspan="3">Bakiye</th>
                        <th class="text-end">{{ balance }} TRY</th>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>
{% endblock %}
